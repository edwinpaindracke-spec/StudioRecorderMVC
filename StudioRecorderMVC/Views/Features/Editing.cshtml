@{
    ViewData["Title"] = "Editing Tools";
}

<div class="feature-page">
    <h1 class="page-title">🎛️ Built-In Editing Tools</h1>
    <p class="page-description">
        Upload your audio and edit it visually using our waveform editor.
    </p>

    <!-- Upload Section -->
    <div class="upload-box">
        <input type="file" id="audioInput" accept="audio/*" hidden />
        <button id="uploadBtn" class="upload-btn">📁 Upload Audio</button>
    </div>


    <!-- Waveform Container -->
    <div id="waveform" class="waveform-container"></div>

    <!-- Controls -->
    <div class="waveform-controls" id="controls" style="display:none;">
        <button id="playPauseBtn" class="control-btn">▶ Play</button>

        <label class="zoom-label">Zoom:</label>
        <input type="range" id="zoomSlider" min="0" max="200" value="0" />
    </div>
</div>
<div class="container">

    <h2>Audio Editing Tools</h2>

    <a class="btn btn-primary" href="/Edit/Cut">✂️ Cut / Trim</a>
    <a class="btn btn-secondary" href="/Edit/Volume">🔊 Volume</a>
    <a class="btn btn-warning" href="/Edit/Mix">🎚️ Mix</a>
    <a class="btn btn-success" href="/Edit/Export">💾 Export</a>

</div>

<!-- Script -->
<script src="https://unpkg.com/wavesurfer.js"></script>

<script>
    let wavesurfer;

    const uploadBtn = document.getElementById("uploadBtn");
    const audioInput = document.getElementById("audioInput");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const zoomSlider = document.getElementById("zoomSlider");
    const controls = document.getElementById("controls");

    uploadBtn.onclick = () => audioInput.click();

    audioInput.onchange = () => {
        const file = audioInput.files[0];
        if (!file) return;

        if (wavesurfer) {
            wavesurfer.destroy();
        }

        const audioURL = URL.createObjectURL(file);

        // Init WaveSurfer
        wavesurfer = WaveSurfer.create({
            container: "#waveform",
            waveColor: "#a0a0ff",
            progressColor: "#6c63ff",
            cursorColor: "#333",
            height: 140,
        });

        wavesurfer.load(audioURL);
        controls.style.display = "flex";
    };

    playPauseBtn.onclick = () => {
        wavesurfer.playPause();
        playPauseBtn.textContent = wavesurfer.isPlaying() ? "⏸ Pause" : "▶ Play";
    };

    zoomSlider.oninput = () => {
        wavesurfer.zoom(Number(zoomSlider.value));
    };
</script>
